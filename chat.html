<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>GitHub掲示板</title>
</head>
<body>

  <header>
    <h1>GitHub掲示板</h1>
  </header>

  <div id="board">
    <ul class="threads">
      <!-- ここにスレッド一覧が表示されます -->
    </ul>
  </div>

  <form id="new-thread" action="/new-thread" method="post">
    <input type="text" name="title" placeholder="スレッドタイトル">
    <input type="text" name="message" placeholder="投稿内容">
    <input type="submit" value="新規スレッド作成">
  </form>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    // スレッド一覧を取得する
    $.ajax({
      url: "/threads",
      type: "get",
      success: function(data) {
        for (var i = 0; i < data.length; i++) {
          var thread = data[i];
          var li = $("<li>");
          li.append($("<a href='/thread/" + thread.id + "'>" + thread.title + "</a>"));
          li.append($("<span class='last-post'>" + thread.last_post_at + "</span>"));
          $(".threads").append(li);
        }
      }
    });

    // 新規スレッド作成
    $("#new-thread").submit(function(event) {
      event.preventDefault();
      $.ajax({
        url: $(this).attr("action"),
        type: $(this).attr("method"),
        data: $(this).serialize(),
        success: function(data) {
          // スレッドを追加する
          var li = $("<li>");
          li.append($("<a href='/thread/" + data.id + "'>" + data.title + "</a>"));
          li.append($("<span class='last-post'>" + data.last_post_at + "</span>"));
          $(".threads").append(li);
        }
      });
    });
  </script>

</body>
</html>
