<html>
<head>
  <meta charset="utf-8">
  <title>オンライン掲示板</title>
  <style>
    body {
      background-color: #f0e0d6;
      font-family: "メイリオ", Meiryo, sans-serif;
    }
    h1 {
      text-align: center;
      color: #800000;
    }
    #thread {
      width: 80%;
      margin: 0 auto;
      border: solid 1px #800000;
    }
    .post {
      padding: 10px;
      border-bottom: dashed 1px #800000;
    }
    .post-number {
      color: #800000;
      font-weight: bold;
    }
    .post-name {
      color: #008000;
      font-weight: bold;
    }
    .post-date {
      color: #000080;
    }
    .post-content {
      margin-top: 10px;
      white-space: pre-wrap;
    }
    #form {
      width: 80%;
      margin: 20px auto;
      text-align: center;
    }
    input, textarea {
      font-size: 16px;
    }
    input[type="text"] {
      width: 300px;
    }
    textarea {
      width: 600px;
      height: 200px;
    }
    input[type="submit"] {
      width: 100px;
      height: 40px;
      background-color: #800000;
      color: white;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>オンライン掲示板</h1>
  <div id="thread"></div>
  <div id="form">
    <p>名前：<input type="text" id="name" value="名無しさん"></p>
    <p>内容：</p>
    <p><textarea id="content"></textarea></p>
    <p><input type="submit" id="submit" value="書き込む"></p>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.10.0/firebase-app.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/8.10.0/firebase-database.js"></script>
  <script>
    // Initialize Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyD-9tSrke72PouQMnMX-a7eZSW0jkFMBWY",
      authDomain: "fir-chat-9f5a9.firebaseapp.com",
      databaseURL: "https://fir-chat-9f5a9-default-rtdb.firebaseio.com",
      projectId: "fir-chat-9f5a9",
      storageBucket: "fir-chat-9f5a9.appspot.com",
      messagingSenderId: "527413584875",
      appId: "1:527413584875:web:a4c7d12ae8e6bace7f8c28"
    };
    
    firebase.initializeApp(firebaseConfig);
    
    // Get a reference to the database service
    var database = firebase.database();
    
    // Get the elements
    var thread = document.getElementById("thread");
    var name = document.getElementById("name");
    var content = document.getElementById("content");
    var submit = document.getElementById("submit");
    
    // Listen for new posts
    database.ref("posts").on("child_added", function(snapshot) {
      
      // Get the post data
      var post = snapshot.val();
      
      // Create a new div element for the post
      var postDiv = document.createElement("div");
      
      // Set the class name of the post div
      postDiv.className = "post";
      
      // Set the inner HTML of the post div
      postDiv.innerHTML = `
        <span class="post-number">${post.number}</span> 
        <span class="post-name">${post.name}</span> 
        <span class="post-date">${post.date}</span><br>
        <span class="post-content">${post.content}</span>
      `;
      
      // Append the post div to the thread div
      thread.appendChild(postDiv);
      
      // Scroll to the bottom of the thread div
      thread.scrollTop = thread.scrollHeight;
      
    });
    
    // Listen for submit button click
    submit.addEventListener("click", function() {
      
      // Get the name and content values
      var nameValue = name.value.trim();
      var contentValue = content.value.trim();
      
      // Check if the name and content are not empty
      if (nameValue && contentValue) {
        
        // Get the current date and time
        var date = new Date();
        
        // Format the date and time
        var dateValue = date.toLocaleDateString() + " " + date.toLocaleTimeString();
        
        // Get the number of posts
        database.ref("posts").once("value", function(snapshot) {
          
          // Get the number of posts
          var numberOfPosts = snapshot.numChildren();
          
          // Increment the number of posts by one
          var postNumber = numberOfPosts + 1;
          
          // Create a new post object
          var post = {
            number: postNumber,
            name: nameValue,
            date: dateValue,
            content: contentValue
          };
          
          // Push the new post to the database
          database.ref("posts").push(post);
          
          // Clear the content textarea
          content.value = "";
          
        });
        
      }
      
    });
  </script>
</body>
</html>
